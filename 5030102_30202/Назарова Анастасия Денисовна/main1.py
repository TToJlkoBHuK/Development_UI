import enum
import tkinter as tk
from tkinter import messagebox, scrolledtext
from typing import Iterator, Optional, List
import time


class –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä(enum.Enum):
    –î–µ–ø–ª–æ–π–í–ø–µ—Ä—ë–¥ = "–î–µ–ø–ª–æ–π–í–ø–µ—Ä—ë–¥"
    –û—Ç–∫–∞—Ç–ù–∞–∑–∞–¥ = "–û—Ç–∫–∞—Ç–ù–∞–∑–∞–¥"
    –í–ª–µ–≤–æ–°–µ—Ç—å = "–í–ª–µ–≤–æ–°–µ—Ç—å"
    –í–ø—Ä–∞–≤–æ–°–µ—Ç—å = "–í–ø—Ä–∞–≤–æ–°–µ—Ç—å"
    –î–∏–∞–≥Dev–°–ó = "–î–∏–∞–≥Dev–°–ó"
    –î–∏–∞–≥Dev–Æ–í = "–î–∏–∞–≥Dev–Æ–í"


class –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤(enum.IntEnum):
    –°–µ—Ä–≤–µ—Ä = 0
    –¢–µ—Ä–º–∏–Ω–∞–ª = 1
    –†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ = 2
    –ö–æ–¥ = 3
    –ë–∞–≥ = 4
    –§–∏–Ω–∏—à = 5
    –°–µ—Ç—å = 6


class –Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç:
    def –∫–æ–ø–∏—è(self):
        return –Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç(
            self.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞,
            self.—Ç–∏–ø_—è—á–µ–π–∫–∏
        )
    def __init__(self, —è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞: bool, —Ç–∏–ø_—è—á–µ–π–∫–∏: –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤):
        self.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = —è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞
        self.—Ç–∏–ø_—è—á–µ–π–∫–∏ = —Ç–∏–ø_—è—á–µ–π–∫–∏

    def –ø–æ–ª—É—á–∏—Ç—å_–∑–Ω–∞—á–µ–Ω–∏–µ(self) -> int:
        –∑–Ω–∞—á–µ–Ω–∏–µ = int(self.—Ç–∏–ø_—è—á–µ–π–∫–∏)
        if self.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞:
            –∑–Ω–∞—á–µ–Ω–∏–µ |= 0x8
        return –∑–Ω–∞—á–µ–Ω–∏–µ

    def __repr__(self) -> str:
        return f"–Ø—á–µ–π–∫–∞(—Ä–æ–±–æ—Ç={self.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞}, —Ç–∏–ø=0x{self.–ø–æ–ª—É—á–∏—Ç—å_–∑–Ω–∞—á–µ–Ω–∏–µ():X})"

    def __eq__(self, other):
        if not isinstance(other, –Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç):
            return False
        return (self.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ == other.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ and
                self.—Ç–∏–ø_—è—á–µ–π–∫–∏ == other.—Ç–∏–ø_—è—á–µ–π–∫–∏)


class –õ–∞–±–∏—Ä–∏–Ω—Ç–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç:
    def __init__(self, —à–∏—Ä–∏–Ω–∞: int, –¥–ª–∏–Ω–∞: int):
        self.—à–∏—Ä–∏–Ω–∞ = —à–∏—Ä–∏–Ω–∞
        self.–¥–ª–∏–Ω–∞ = –¥–ª–∏–Ω–∞
        self.—è—á–µ–π–∫–∏: List[List[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]] = []

    def –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å–õ–∞–±–∏—Ä–∏–Ω—Ç(self, —Ç–∏–ø_—è—á–µ–π–∫–∏: –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤):
        self.—è—á–µ–π–∫–∏ = []
        for y in range(self.–¥–ª–∏–Ω–∞):
            row = []
            for x in range(self.—à–∏—Ä–∏–Ω–∞):
                row.append(–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç(False, —Ç–∏–ø_—è—á–µ–π–∫–∏))
            self.—è—á–µ–π–∫–∏.append(row)

    def –ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(self, —Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞: –Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç,
                               –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞: –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        current_x = current_y = -1
        for y in range(self.–¥–ª–∏–Ω–∞):
            for x in range(self.—à–∏—Ä–∏–Ω–∞):
                if self.—è—á–µ–π–∫–∏[y][x] is —Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞:
                    current_x, current_y = x, y
                    break
            if current_x != -1:
                break

        if current_x == -1 or current_y == -1:
            return None

        if –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞ == –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–î–µ–ø–ª–æ–π–í–ø–µ—Ä—ë–¥:
            dx, dy = (0, 1)
        elif –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞ == –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–û—Ç–∫–∞—Ç–ù–∞–∑–∞–¥:
            dx, dy = (0, -1)
        elif –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞ == –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–í–ª–µ–≤–æ–°–µ—Ç—å:
            dx, dy = (-1, 0)
        elif –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞ == –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–í–ø—Ä–∞–≤–æ–°–µ—Ç—å:
            dx, dy = (1, 0)
        elif –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞ == –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–î–∏–∞–≥Dev–°–ó:
            dx, dy = (-1, 1)
        elif –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_–ø–æ–∏—Å–∫–∞ == –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–î–∏–∞–≥Dev–Æ–í:
            dx, dy = (1, -1)
        else:
            return None

        new_x, new_y = current_x + dx, current_y + dy

        if not (0 <= new_x < self.—à–∏—Ä–∏–Ω–∞ and 0 <= new_y < self.–¥–ª–∏–Ω–∞):
            return None

        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.—è—á–µ–π–∫–∏[new_y][new_x]

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ in (–¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–°–µ—Ä–≤–µ—Ä, –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ë–∞–≥):
            return None

        return –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

    def –ü–æ–ª—É—á–∏—Ç—å–ò—Ç–µ—Ä–∞—Ç–æ—Ä(self) -> Iterator[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if not self.—è—á–µ–π–∫–∏ or self.–¥–ª–∏–Ω–∞ == 0 or self.—à–∏—Ä–∏–Ω–∞ == 0:
            return

        x, y = 0, self.–¥–ª–∏–Ω–∞ - 1
        direction = 1

        while y >= 0:
            yield self.—è—á–µ–π–∫–∏[y][x]

            if direction == 1:
                if x + 1 < self.—à–∏—Ä–∏–Ω–∞:
                    x += 1
                else:
                    y -= 1
                    if y >= 0:
                        direction = -1
            else:
                if x - 1 >= 0:
                    x -= 1
                else:
                    y -= 1
                    if y >= 0:
                        direction = 1


class –†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç:
    def __init__(self, –ª–∞–±–∏—Ä–∏–Ω—Ç: –õ–∞–±–∏—Ä–∏–Ω—Ç–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç):
        self.–ª–∞–±–∏—Ä–∏–Ω—Ç = –ª–∞–±–∏—Ä–∏–Ω—Ç
        self.–¥–µ–ø–ª–æ—ç–Ω–µ—Ä–≥–∏—è: Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç] = None
        self.–æ—Ç–∫–∞—Ç–Ω—ã–π: Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç] = None

        # –ù–∞—Ö–æ–¥–∏–º —è—á–µ–π–∫—É —Å —Ä–æ–±–æ—Ç–æ–º
        self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = None
        for y in range(self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–¥–ª–∏–Ω–∞):
            for x in range(self.–ª–∞–±–∏—Ä–∏–Ω—Ç.—à–∏—Ä–∏–Ω–∞):
                if self.–ª–∞–±–∏—Ä–∏–Ω—Ç.—è—á–µ–π–∫–∏[y][x].—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞:
                    self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.—è—á–µ–π–∫–∏[y][x]
                    return

    def –î–µ–ø–ª–æ–π–Ω—É—Ç—å(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞, –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–î–µ–ø–ª–æ–π–í–ø–µ—Ä—ë–¥)

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ = —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞:
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = False
            –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = True
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

        return —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ

    def –û—Ç–∫–∞—Ç–Ω—É—Ç—å(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞, –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–û—Ç–∫–∞—Ç–ù–∞–∑–∞–¥)

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ = —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞:
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = False
            –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = True
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

        return —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ

    def –°–¥–≤–∏–Ω—É—Ç—å–í–ª–µ–≤–æ(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞, –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–í–ª–µ–≤–æ–°–µ—Ç—å)

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ = —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞:
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = False
            –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = True
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

        return —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ

    def –°–¥–≤–∏–Ω—É—Ç—å–í–ø—Ä–∞–≤–æ(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞, –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–í–ø—Ä–∞–≤–æ–°–µ—Ç—å)

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ = —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞:
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = False
            –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = True
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

        return —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ

    def –ü–æ–¥–Ω—è—Ç—å–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞, –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–î–∏–∞–≥Dev–°–ó)

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ = —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞:
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = False
            –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = True
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

        return —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ

    def –û–ø—É—Å—Ç–∏—Ç—å–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞ = self.–ª–∞–±–∏—Ä–∏–Ω—Ç.–ü–æ–ª—É—á–∏—Ç—å–°–æ—Å–µ–¥–Ω—é—é–Ø—á–µ–π–∫—É(
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞, –¢–∏–ø–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–πDevOps–ù–∞–ø—Ä.–î–∏–∞–≥Dev–Æ–í)

        —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ = —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞:
            —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = False
            –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = True
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ = –Ω–æ–≤–∞—è_—è—á–µ–π–∫–∞

        return —Å—Ç–∞—Ä–∞—è_—è—á–µ–π–∫–∞_–¥–æ

    def –ö–æ–¥(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        –¥–æ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ == –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ö–æ–¥:
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ = –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ

        return –¥–æ

    def –¢–µ—Ä–º–∏–Ω–∞–ª(self) -> Optional[–Ø—á–µ–π–∫–∞–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç]:
        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is None:
            return None

        –¥–æ = self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.–∫–æ–ø–∏—è()

        if self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ == –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–¢–µ—Ä–º–∏–Ω–∞–ª:
            self.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ = –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ö–æ–¥

        return –¥–æ


class DevOpsApp:
    def __init__(self, root, width=5, height=6):
        self.root = root
        self.root.title("–†–æ–±–æ—Ç-–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç")

        self.lab = –õ–∞–±–∏—Ä–∏–Ω—Ç–†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç(width, height)
        self.lab.–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å–õ–∞–±–∏—Ä–∏–Ω—Ç(–¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–°–µ—Ä–≤–µ—Ä)

        self._setup_demo_map()
        self.robot = –†–æ–±–æ—Ç–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç(self.lab)

        self.cell_size = 60
        self.canvas = tk.Canvas(
            root,
            width=width * self.cell_size,
            height=height * self.cell_size,
            bg="white"
        )
        self.canvas.pack(side=tk.LEFT, padx=10, pady=10)

        panel = tk.Frame(root)
        panel.pack(side=tk.RIGHT, fill=tk.Y)

        self.log = scrolledtext.ScrolledText(
            panel,
            width=30,
            height=12,
            state="disabled"
        )
        self.log.pack(fill=tk.BOTH, pady=(0, 10))

        self.auto_running = False

        style = {'bg': '#F0F0F0', 'activebackground': '#E0E0E0', 'relief': 'flat'}

        tk.Button(
            panel,
            text="–ê–≤—Ç–æ",
            bg="#C9E2CD",
            command=self.toggle_auto
        ).pack(fill=tk.X, pady=10)

        tk.Button(panel, text="–î–µ–ø–ª–æ–π",
                  command=lambda: self.step(self.robot.–î–µ–ø–ª–æ–π–Ω—É—Ç—å)).pack(fill=tk.X)

        tk.Button(panel, text="–û—Ç–∫–∞—Ç",
                  command=lambda: self.step(self.robot.–û—Ç–∫–∞—Ç–Ω—É—Ç—å)).pack(fill=tk.X)

        tk.Button(panel, text="–í–ª–µ–≤–æ",
                  command=lambda: self.step(self.robot.–°–¥–≤–∏–Ω—É—Ç—å–í–ª–µ–≤–æ)).pack(fill=tk.X)

        tk.Button(panel, text="–í–ø—Ä–∞–≤–æ",
                  command=lambda: self.step(self.robot.–°–¥–≤–∏–Ω—É—Ç—å–í–ø—Ä–∞–≤–æ)).pack(fill=tk.X)

        tk.Button(panel, text="–ü–æ–¥–Ω—è—Ç—å",
                  command=lambda: self.step(self.robot.–ü–æ–¥–Ω—è—Ç—å–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä)).pack(fill=tk.X)

        tk.Button(panel, text="–û–ø—É—Å—Ç–∏—Ç—å",
                  command=lambda: self.step(self.robot.–û–ø—É—Å—Ç–∏—Ç—å–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä)).pack(fill=tk.X)

        tk.Button(panel, text="–ö–æ–¥", bg="#F6D6A1",
                  command=lambda: self.step(self.robot.–ö–æ–¥)).pack(fill=tk.X, pady=(10, 0))

        tk.Button(panel, text="–¢–µ—Ä–º–∏–Ω–∞–ª", bg="#D4DDF1",
                  command=lambda: self.step(self.robot.–¢–µ—Ä–º–∏–Ω–∞–ª)).pack(fill=tk.X)


        self.iterator = self.lab.–ü–æ–ª—É—á–∏—Ç—å–ò—Ç–µ—Ä–∞—Ç–æ—Ä()
        self.draw()

    def toggle_auto(self):
        self.auto_running = not self.auto_running
        if self.auto_running:
            self.write_log("–ê–≤—Ç–æ-—Ä–µ–∂–∏–º –∑–∞–ø—É—â–µ–Ω")
            self.auto_step_loop()
        else:
            self.write_log("–ê–≤—Ç–æ-—Ä–µ–∂–∏–º –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

    def auto_step_loop(self):
        if not self.auto_running:
            return

        cur = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞

        if self.handle_cell_action():
            self.draw()
            self.root.after(300, self.auto_step_loop)
            return

        try:
            target = self.auto_target
        except AttributeError:
            try:
                self.auto_target = next(self.iterator)
                target = self.auto_target
            except StopIteration:
                self.finish_check()
                self.auto_running = False
                return

        cx = cy = tx = ty = None

        for y in range(self.lab.–¥–ª–∏–Ω–∞):
            for x in range(self.lab.—à–∏—Ä–∏–Ω–∞):
                if self.lab.—è—á–µ–π–∫–∏[y][x] is cur:
                    cx, cy = x, y
                if self.lab.—è—á–µ–π–∫–∏[y][x] is target:
                    tx, ty = x, y

        prev_cell = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞

        moved = False

        if cx != tx:
            prev = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
            if cx < tx:
                self.robot.–°–¥–≤–∏–Ω—É—Ç—å–í–ø—Ä–∞–≤–æ()
            else:
                self.robot.–°–¥–≤–∏–Ω—É—Ç—å–í–ª–µ–≤–æ()
            moved = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is not prev

        if not moved and cy != ty:
            prev = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
            if cy < ty:
                self.robot.–î–µ–ø–ª–æ–π–Ω—É—Ç—å()
            else:
                self.robot.–û—Ç–∫–∞—Ç–Ω—É—Ç—å()
            moved = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is not prev

        if not moved:
            self.write_log("–ê–≤—Ç–æ: –ø—É—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, —Ü–µ–ª—å –ø—Ä–æ–ø—É—â–µ–Ω–∞")
            try:
                del self.auto_target
                self.auto_target = next(self.iterator)
            except StopIteration:
                ...
            self.root.after(50, self.auto_step_loop)
            return

        if self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is prev_cell:
            self.write_log("–ê–≤—Ç–æ: —Ü–µ–ª—å –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–∞, –ø—Ä–æ–ø—É—Å–∫")
            try:
                self.auto_target = next(self.iterator)
            except StopIteration:
                if self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ == –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–§–∏–Ω–∏—à:
                    self.finish_check()
                else:
                    self.write_log("–ê–≤—Ç–æ: –æ–±—Ö–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω, —Ñ–∏–Ω–∏—à –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç")
                self.auto_running = False
                return            self.root.after(50, self.auto_step_loop)
            return

        if self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞ is target:
            del self.auto_target

        self.draw()
        self.root.after(300, self.auto_step_loop)


    def handle_cell_action(self):
        cell = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞

        if cell.—Ç–∏–ø_—è—á–µ–π–∫–∏ == –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–¢–µ—Ä–º–∏–Ω–∞–ª:
            self.robot.–¢–µ—Ä–º–∏–Ω–∞–ª()
            self.write_log("–ê–≤—Ç–æ: –¢–µ—Ä–º–∏–Ω–∞–ª -> –ö–æ–¥")
            return True

        if cell.—Ç–∏–ø_—è—á–µ–π–∫–∏ == –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ö–æ–¥:
            self.robot.–ö–æ–¥()
            self.write_log("–ê–≤—Ç–æ: –ö–æ–¥ -> –†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ")
            return True

        return False

    def finish_check(self):
        if self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ != –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–§–∏–Ω–∏—à:
            self.show_fail()
            return

        for row in self.lab.—è—á–µ–π–∫–∏:
            for cell in row:
                if cell.—Ç–∏–ø_—è—á–µ–π–∫–∏ in (
                        –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ö–æ–¥,
                        –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–¢–µ—Ä–º–∏–Ω–∞–ª,
                ):
                    self.show_fail()
                    return

        self.show_success()

    def show_success(self):
        messagebox.showinfo(
            "–†–µ–∑—É–ª—å—Ç–∞—Ç",
            "—É—Å–ø–µ—à–Ω—ã–π —É—Å–ø–µ—Ö"
        )
        self.root.destroy()

    def show_fail(self):
        messagebox.showwarning(
            "–†–µ–∑—É–ª—å—Ç–∞—Ç",
            "—Ä–æ–±–æ—Ç –µ—â–µ –Ω–µ –¥–æ–¥–µ–ª–∞–ª –≤—Å–µ"
        )

    def write_log(self, text):
        self.log.config(state="normal")
        self.log.insert(tk.END, text + "\n")
        self.log.see(tk.END)
        self.log.config(state="disabled")

    def step(self, action):
        before = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞
        result = action()
        after = self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞

        if result is None:
            self.write_log("–î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ")
        else:
            self.write_log(f"{action.__name__}: {before} -> {after}")

        if self.robot.—Ç–µ–∫—É—â–∞—è_—è—á–µ–π–∫–∞.—Ç–∏–ø_—è—á–µ–π–∫–∏ == –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–§–∏–Ω–∏—à:
            self.finish_check()

        self.draw()

    def _setup_demo_map(self):
        data = [
            [14, 6, 3, 4, 1],
            [3, 0, 6, 4, 6],
            [6, 0, 6, 6, 3],
            [1, 0, 4, 4, 1],
            [4, 6, 3, 4, 1],
            [5, 0, 1, 3, 6],
        ]

        for y in range(self.lab.–¥–ª–∏–Ω–∞):
            for x in range(self.lab.—à–∏—Ä–∏–Ω–∞):
                v = data[y][x]
                has_robot = v == 14
                cell_type = –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤(v if v != 14 else 6)
                cell = self.lab.—è—á–µ–π–∫–∏[y][x]
                cell.—Ç–∏–ø_—è—á–µ–π–∫–∏ = cell_type
                cell.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞ = has_robot

    def draw(self):
        self.canvas.delete("all")
        h = self.lab.–¥–ª–∏–Ω–∞
        w = self.lab.—à–∏—Ä–∏–Ω–∞

        colors = {
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–°–µ—Ä–≤–µ—Ä: "#B3B3B3",
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–¢–µ—Ä–º–∏–Ω–∞–ª: "#D4DDF1",
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ: "#C9E2CD",
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ö–æ–¥: "#F6D6A1",
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–ë–∞–≥: "#EBACAB",
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–§–∏–Ω–∏—à: "#896487",
            –¢–∏–ø–Ø—á–µ–µ–∫–°–µ—Ä–≤–µ—Ä–æ–≤.–°–µ—Ç—å: "#F9F0EE",
        }

        for y in range(h):
            for x in range(w):
                cell = self.lab.—è—á–µ–π–∫–∏[y][x]
                gui_y = (h - 1 - y) * self.cell_size
                gui_x = x * self.cell_size

                color = colors[cell.—Ç–∏–ø_—è—á–µ–π–∫–∏]
                self.canvas.create_rectangle(
                    gui_x,
                    gui_y,
                    gui_x + self.cell_size,
                    gui_y + self.cell_size,
                    fill=color,
                    outline="white",
                )

                if cell.—è—á–µ–π–∫–∞_—Ä–æ–±–æ—Ç–∞:
                    self.canvas.create_text(
                        gui_x + 30,
                        gui_y + 30,
                        font= ("Arial", 40),
                        text="ü§ñ",
                    )



if __name__ == "__main__":
    root = tk.Tk()
    DevOpsApp(root)
    root.mainloop()